{% extends 'home/base.html' %}
{% load static %}
{% block title %}{{ page }} {{ hashtag_post|upper }} {{ post_id }}{% endblock %}
{% block data %}
    <div style="display:none" id="data_post" hashtag_post="{{ hashtag_post }}" post_id="{{ post_id }}"
    ></div>
{% endblock data %}
<script src="https://cdn.jsdelivr.net/npm/vue@2.6.12/dist/vue.js"></script>
{% block noidung %}
    <template v-for="item in api_post.result">
        <div class="baidang mb-5">
            <div class="post_thongtin">
                <img v-if="item.avatar" :src="`/media/${item.avatar}`" class="post_avatar"
                     :alt="item.avatar" alt="">
                <img v-else src="{% static 'user/images/avatar.png' %}" class="post_avatar"
                     alt="">
                <div>
                    <div>
                        <a class="post_name"
                           :href="`http://127.0.0.1:8000/profile/${item.username}`">[[item.full_name]]</a>
                        <label class="post_feeling"><i
                                class="fas fa-check-circle"></i> [[item.feeling]]</label>
                    </div>
                    <div>
                                        <span class="post_time"
                                              @click="open_link(domain+`/post/${item.post_id}/`)"

                                        >[[item.created_at]] </span>
                        <label class="post_public"><i
                                class="fas fa-globe-europe"> </i> [[item.public]]</label>
                    </div>
                </div>
                <div class="dropdown" v-if="user_id == item.user_id">
                    <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton"
                            data-bs-toggle="dropdown" aria-expanded="false">
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end  dropdown-menu-dark "
                        aria-labelledby="dropdownMenuButton">
                        <li @click="open_link(domain+`/post/edit/${item.post_id}/`)"><a class="dropdown-item" href="#">Chỉnh
                            sửa bài viết</a></li>
                        <li @click="delete_post(item.post_id)"><a class="dropdown-item" href="#">Xóa bài viết này</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="post_content">[[item.content]]</div>
            <div class="post_hashtag">
                <div @click="open_link(domain+`/post/hashtag/${item.hashtag.toLowerCase()}`)">
                    <i class="fas fa-hashtag"></i>[[item.hashtag]]
                </div>
            </div>
            <img v-if="item.photo" :src="`/media/${item.photo}`" class="post_image"
                 :alt="item.photo" alt="">
            <template v-for="cmt in comment.comment_show[`${item.post_id}`]">
                <template v-for="key in cmt">
                    <div class="comment">
                        <div>
                                    <span class="comment_name"
                                          @click="open_link(`/profile/${ key.username}`)">
                                        [[key.fullname]]
                                       </span>
                            <span class="comment_created"><i
                                    class="fas fa-clock"></i> [[key.created_at]]
                                    </span>
                        </div>
                        <div class="comment_content">[[key.content]]</div>
                        <template v-if="user_id == key.user_id ">
                            <i @click="comment_delete_func(item.post_id,key.comment_id)"
                               class="fas fa-times"></i>
                        </template>
                    </div>
                </template>
            </template>
            <div class="form-comment">
                <input type="hidden" v-model="comment.content_input1[`${item.post_id}`]">
                <input type="text" v-model="comment.content_input[`${item.post_id}`]"
                       @keyup.enter="comment_func(item.post_id)"
                       class="form-control"
                       placeholder="Để lại bình luận của bạn">
                <button class="btn btn-dark" @click="comment_show_func(item.post_id)">show cmt</button>
            </div>
        </div>
    </template>
{% endblock noidung %}

<script src="{% static 'home/javascript/bai_viet.js' %}"></script>